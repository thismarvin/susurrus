function t(t,e,r){return function(t,e,r){const s=t.createProgram();if(null===s)throw new Error("Something went wrong; could not create WebGLProgram.");if(t.attachShader(s,e),t.attachShader(s,r),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS))throw new Error("An error occurred while initializing the shader program: "+t.getProgramInfoLog(s));return s}(t,s(t,t.VERTEX_SHADER,e),s(t,t.FRAGMENT_SHADER,r))}function e(t,e,r,s){const i=t.createBuffer();if(null===i)throw new Error("Something went wrong; could not create WebGLBuffer.");return t.bindBuffer(e,i),t.bufferData(e,r,s),i}function r(t,e,r,s){t.bindBuffer(e,r),t.bufferSubData(e,0,s)}function s(t,e,r){const s=t.createShader(e);if(null===s)throw new TypeError(`'${e}' is not a valid WebGL shader type.`);if(t.shaderSource(s,r),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS)){const e=new Error("An error occurred will compiling the shader: "+t.getShaderInfoLog(s));throw t.deleteShader(s),e}return s}function i(t,e,r){let s=!0;switch(e.toLowerCase()){case"array":s=Array.isArray(t);break;default:s=typeof t===e}return a(s,r,`Expected value to be a(n) '${e}'.`)}function n(t,e,r){return a(t instanceof e,r,`Expected value to be an instance of '${e.name}'.`)}function a(t,e,r){const s=()=>{throw new TypeError(r)};if(void 0!==e){if("object"==typeof e){if(void 0!==e.throwError&&"boolean"==typeof e.throwError&&!e.throwError)return t;if(!t){if(void 0!==e.errorMessage){if("string"==typeof e.errorMessage&&e.errorMessage.length>0)throw new TypeError(e.errorMessage);s()}if(void 0!==e.addendum){if("string"==typeof e.addendum&&e.addendum.length>0)throw new TypeError(`${r} ${e.addendum}`);s()}}}}else t||s()}var o,h,l,c,u=function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},f=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class d{constructor(t,e){switch(o.set(this,void 0),h.set(this,void 0),l.set(this,void 0),c.set(this,void 0),u(this,o,0),u(this,h,0),u(this,l,0),u(this,c,1),typeof t){case"number":u(this,o,this.validateValue(((16711680&t)>>16)/255)),u(this,h,this.validateValue(((65280&t)>>8)/255)),u(this,l,this.validateValue((255&t)/255));break;case"string":{const e=parseInt(t,16);u(this,o,this.validateValue(((16711680&e)>>16)/255)),u(this,h,this.validateValue(((65280&e)>>8)/255)),u(this,l,this.validateValue((255&e)/255));break}}void 0!==e&&this.multiply(this.validateValue(e))}get r(){return f(this,o)}set r(t){u(this,o,this.validateValue(t))}get g(){return f(this,h)}set g(t){u(this,h,this.validateValue(t))}get b(){return f(this,l)}set b(t){u(this,l,this.validateValue(t))}get a(){return f(this,c)}set a(t){u(this,c,this.validateValue(t))}fromRGB(t,e,r,s){return u(this,o,this.validateValue(t/255)),u(this,h,this.validateValue(e/255)),u(this,l,this.validateValue(r/255)),void 0!==s&&this.multiply(this.validateValue(s)),this}multiply(t){u(this,o,this.validateValue(f(this,o)*t)),u(this,h,this.validateValue(f(this,h)*t)),u(this,l,this.validateValue(f(this,l)*t)),u(this,c,this.validateValue(f(this,c)*t))}toArray(){return[f(this,o),f(this,h),f(this,l),f(this,c)]}toString(){const t=Math.floor(255*f(this,o)),e=Math.floor(255*f(this,h)),r=Math.floor(255*f(this,l));let s=t.toString(16);1===s.length&&(s="0"+s);let i=e.toString(16);1===i.length&&(i="0"+i);let n=r.toString(16);return 1===n.length&&(n="0"+n),`(${t} ${e} ${r}) ${f(this,c).toFixed(4)}, 0x${s}${i}${n}`}validateValue(t){return t<1/255?0:t>1?1:Math.floor(t/(1/255))*(1/255)}}o=new WeakMap,h=new WeakMap,l=new WeakMap,c=new WeakMap;const w={VERTEX:0,INDEX:1};Object.freeze(w);var p,g=function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},m=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class y{constructor(t,e,r){p.set(this,void 0),this.length=e,this.type=r,g(this,p,t),this.data=null,this.buffer=null,Object.defineProperty(this,"length",{writable:!1}),Object.defineProperty(this,"type",{writable:!1})}setData(t){if(null===this.data||null==this.buffer)throw new Error;if(t.length!=this.length)throw new TypeError(`Expected an array with ${this.length} element(s). Received an array with ${t.length} element(s) instead.`);switch(this.data.set(t),this.type){case w.VERTEX:!function(t,e,s){r(t,t.ARRAY_BUFFER,e,s)}(m(this,p).gl,this.buffer,this.data);break;case w.INDEX:!function(t,e,s){r(t,t.ELEMENT_ARRAY_BUFFER,e,s)}(m(this,p).gl,this.buffer,this.data);break;default:throw new TypeError(`'${this.type}' is an invalid BufferType.`)}}}p=new WeakMap;class b extends y{constructor(t,r,s,i,n){super(t,s,w.VERTEX),this.attributeSchema=r,this.vertexUsage=i,this.instanceFrequency=n||0,this.data=new Float32Array(this.length),this.buffer=function(t,r,s){let i=r;switch(s){case t.DYNAMIC_DRAW:i=4*r}return e(t,t.ARRAY_BUFFER,i,s)}(t.gl,this.data.byteLength,this.vertexUsage),Object.defineProperty(this,"attributeSchema",{writable:!1}),Object.defineProperty(this,"vertexUsage",{writable:!1}),Object.defineProperty(this,"instanceFrequency",{writable:!1})}}var v,E=function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},T=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class A{constructor(t){v.set(this,void 0),this.gl=t,this.extensions={ANGLE_instanced_arrays:this.gl.getExtension("ANGLE_instanced_arrays")},E(this,v,null),function(t){t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)}(this.gl),Object.defineProperty(this,"gl",{writable:!1}),Object.defineProperty(this,"extensions",{writable:!1})}clear(t){var e,r,s,i,a;n(t,d),e=this.gl,r=t.r,s=t.g,i=t.b,a=t.a,e.clearColor(r,s,i,a),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}begin(t){E(this,v,t.program),this.gl.useProgram(T(this,v))}setVertexBuffer(t){if(null===T(this,v))throw new Error("'begin(effect)' must be called before setting a VertexBuffer.");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.buffer);for(let e of t.attributeSchema.elements){const r=this.gl.getAttribLocation(T(this,v),e.name);if(r<0)throw new Error(`The current program does not have a(n) '${e.name}' attribute.`);this.gl.enableVertexAttribArray(r),this.gl.vertexAttribPointer(r,e.size,e.type,!1,e.stride,e.offset),t.instanceFrequency>0&&this.extensions.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(r,t.instanceFrequency)}}setVertexBuffers(t){for(let e of t)this.setVertexBuffer(e)}setIndexBuffer(t){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t.buffer)}setUniform(t,e){if(null===T(this,v))throw new Error("'begin(effect)' must be called before setting a uniform.");const r=this.gl.getUniformLocation(T(this,v),t);this.gl.uniformMatrix4fv(r,!1,e)}drawArrays(t,e,r){this.gl.drawArrays(t,e,r)}drawElements(t,e,r){this.gl.drawElements(t,3*e,this.gl.UNSIGNED_SHORT,r)}drawInstancedElements(t,e,r,s){this.extensions.ANGLE_instanced_arrays.drawElementsInstancedANGLE(t,3*e,this.gl.UNSIGNED_SHORT,r,s)}deleteBuffer(t){if(null===T(this,v))throw new Error("'begin(effect)' must be called before deleting a Buffer.");if(n(t,b,{throwError:!1})){const e=t;for(let t of e.attributeSchema.elements){const e=this.gl.getAttribLocation(T(this,v),t.name);if(e<0)throw new Error(`The current program does not have a(n) '${t.name}' attribute.`);this.gl.disableVertexAttribArray(e)}}this.gl.deleteBuffer(t.buffer)}end(){E(this,v,null)}}v=new WeakMap;var _,x=function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},O=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class S{constructor(t){_.set(this,void 0);const e=document.getElementById(t);if(null===e)throw new TypeError(`Could not find an element with an id of '${t}'.`);this.parent=e,this.canvas=document.createElement("canvas"),this.parent.appendChild(this.canvas),this.canvas.id=t+"-canvas",this.canvas.width=400,this.canvas.height=400,this.graphics=new A(function(t){const e=t.getContext("webgl");if(null===e)throw new Error("WebGL is not supported on this device.");return e}(this.canvas)),x(this,_,!1),this.loop=!0,Object.defineProperty(this,"parent",{writable:!1}),Object.defineProperty(this,"canvas",{writable:!1}),Object.defineProperty(this,"graphics",{writable:!1})}run(){O(this,_)||(this.initialize(),x(this,_,!0)),this.update(),this.draw(),this.loop&&window.requestAnimationFrame(this.run.bind(this))}initialize(){}update(){}draw(){}}_=new WeakMap;class B{constructor(t,e,r){this.name=t,this.size=e,this.type=r,this.stride=-1,this.offset=-1,Object.defineProperty(this,"name",{writable:!1}),Object.defineProperty(this,"size",{writable:!1}),Object.defineProperty(this,"type",{writable:!1})}}const R={BYTE:5120,SHORT:5122,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,FIXED:void 0,FLOAT:5126};Object.freeze(R);const L={BYTE:1,SHORT:2,UNSIGNED_BYTE:1,UNSIGNED_SHORT:2,FIXED:void 0,FLOAT:4};Object.freeze(L);class z{constructor(t){this.elements=t;const e=function(t){let e=0,r=0,s=[];for(let i of t)switch(e+=i.size,s.push(r),i.type){case R.FLOAT:r+=L.FLOAT*i.size;break;default:throw new TypeError("Unsupported attribute type.")}for(let e=0;e<t.length;e++)t[e].stride=r,t[e].offset=s[e];return{size:e,stride:r}}(this.elements);this.size=e.size,this.stride=e.stride,Object.defineProperty(this,"elements",{writable:!1}),Object.defineProperty(this,"size",{writable:!1}),Object.defineProperty(this,"stride",{writable:!1})}}const N={vertex:"\n        uniform mat4 worldViewProjection;\n\n        attribute vec3 a_position;\n        attribute vec3 a_translation;\n        attribute vec3 a_scale;\n        attribute vec3 a_rotationOffset;\n        attribute float a_rotation;\n        attribute vec4 a_color;\n\n        varying lowp vec4 v_color;\n\n        mat4 createTranslation(vec3 translation) {\n            return mat4(\n                1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                translation.x, translation.y, translation.z, 1\n            );\n        }\n\n        mat4 createScale(vec3 scale) {\n            return mat4(\n                scale.x, 0, 0, 0,\n                0, scale.y, 0, 0,\n                0, 0, scale.z, 0,\n                0, 0, 0, 1\n            );\n        }\n\n        mat4 createRotationZ(float theta) {\n            return mat4(\n                cos(theta), -sin(theta), 0, 0,\n                sin(theta), cos(theta), 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1\n            );\n        }\n\n        void main() {\n            mat4 transform = createTranslation(a_rotationOffset) * createRotationZ(a_rotation) * createTranslation(-a_rotationOffset + a_translation) * createScale(a_scale);\n            gl_Position = transform * vec4(a_position, 1) * worldViewProjection;\n            v_color = a_color;\n        }\n    ",fragment:"\n        varying lowp vec4 v_color;\n\n        void main() {\n            gl_FragColor = v_color;\n        }\n    "};class P{constructor(e,r,s){this.program=t(e.gl,r,s),Object.defineProperty(this,"program",{writable:!1})}}class I extends P{constructor(t){super(t,N.vertex,N.fragment)}}const M={Black:new d(0),White:new d(16777215),Red:new d(16711680),Green:new d(65280),Blue:new d(255),SkyBlue:new d(2731519)};Object.freeze(M);const V={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};Object.freeze(V);class F extends y{constructor(t,r){var s,i;super(t,r,w.INDEX),this.data=new Int16Array(this.length),this.buffer=(s=t.gl,i=this.data.byteLength,e(s,s.ELEMENT_ARRAY_BUFFER,i,s.STATIC_DRAW))}}const j={STREAM:35040,STATIC:35044,DYNAMIC:35048};Object.freeze(j);class D{constructor(t,e,r){this.x=t,this.y=e,this.z=r}multiply(t){this.x*=t,this.y*=t,this.z*=t}divide(t){this.x/=t,this.y/=t,this.z/=t}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){const t=this.length();t>0&&this.divide(t)}toArray(){return[this.x,this.y,this.z]}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static cross(t,e){const r=t.y*e.z-e.y*t.z,s=-(t.x*e.z-e.x*t.z),i=t.x*e.y-e.x*t.y;return new D(r,s,i)}static subtract(t,e){const r=t.x-e.x,s=t.y-e.y,i=t.z-e.z;return new D(r,s,i)}}var k,U,G,W,$,C,Y=function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},H=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};const X=new z([new B("a_translation",3,R.FLOAT),new B("a_scale",3,R.FLOAT),new B("a_rotationOffset",3,R.FLOAT),new B("a_rotation",1,R.FLOAT),new B("a_color",4,R.FLOAT)]);class q{constructor(t,e){k.set(this,void 0),U.set(this,void 0),G.set(this,void 0),W.set(this,void 0),$.set(this,void 0),C.set(this,void 0),this.geometry=e,this.attributeSchema=X,Y(this,k,new D(0,0,0)),Y(this,U,new D(1,1,1)),Y(this,G,new D(0,0,0)),Y(this,W,0),Y(this,$,new d(16777215)),this.transformBuffer=new b(t,this.attributeSchema,1*this.attributeSchema.size,j.DYNAMIC,1),this.updateBuffer(),Y(this,C,!1),Object.defineProperty(this,"geometry",{writable:!1}),Object.defineProperty(this,"attributeSchema",{writable:!1}),Object.defineProperty(this,"transformBuffer",{writable:!1})}get position(){return H(this,k)}set position(t){t!==H(this,k)&&(Y(this,k,t),Y(this,C,!0))}get scale(){return H(this,U)}set scale(t){t!==H(this,U)&&(Y(this,U,t),Y(this,C,!0))}get rotationOffset(){return H(this,G)}set rotationOffset(t){t!==H(this,G)&&(Y(this,G,t),Y(this,C,!0))}get rotation(){return H(this,W)}set rotation(t){t!==H(this,W)&&(Y(this,W,t),Y(this,C,!0))}get color(){return H(this,$)}set color(t){t!==H(this,$)&&(Y(this,$,t),Y(this,C,!0))}applyChanges(){Y(this,C,!1),this.updateBuffer()}draw(t,e,r){H(this,C)&&this.applyChanges(),t.begin(e),t.setVertexBuffers([this.geometry.vertexBuffer,this.transformBuffer]),t.setIndexBuffer(this.geometry.indexBuffer),t.setUniform("worldViewProjection",r.worldViewProjection.data),t.drawElements(V.TRIANGLES,this.geometry.totalTriangles,0),t.end()}updateBuffer(){let t=[];t=t.concat(H(this,k).toArray()),t=t.concat(H(this,U).toArray()),t=t.concat(H(this,G).toArray()),t=t.concat(H(this,W)),t=t.concat(H(this,$).toArray()),this.transformBuffer.setData(t)}}k=new WeakMap,U=new WeakMap,G=new WeakMap,W=new WeakMap,$=new WeakMap,C=new WeakMap;const Z=new z([new B("a_position",3,R.FLOAT)]);class K{constructor(t,e,r){this.vertexBuffer=new b(t,Z,e.length,j.STATIC),this.indexBuffer=new F(t,r.length),this.totalVertices=e.length/3,this.totalTriangles=r.length/3,this.vertexBuffer.setData(e),this.indexBuffer.setData(r)}}var J,Q,tt,et=function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},rt=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class st{constructor(t,e,r){J.set(this,void 0),Q.set(this,void 0),tt.set(this,void 0),et(this,J,t),et(this,Q,e),et(this,tt,new Array(rt(this,J)*rt(this,Q)).fill(0)),void 0!==r&&this.setData(r)}get rows(){return rt(this,J)}get columns(){return rt(this,Q)}get data(){return rt(this,tt)}get(t,e){return this.data[this.columns*e+t]}setData(t){if(i(t,"array"),t.length!==this.rows*this.columns)throw new TypeError("The data does not match the dimensions of the matrix.");et(this,tt,t.slice(0))}set(t,e,r){i(r,"number"),rt(this,tt)[this.columns*e+t]=r}transpose(){const t=new Array(this.rows*this.columns).fill(0),e=this.columns,r=this.rows;for(let s=0;s<e;s++)for(let e=0;e<r;e++)t[r*s+e]=this.data[this.columns*e+s];et(this,tt,t),et(this,J,e),et(this,Q,r)}add(t){if(i(t,"number",{throwError:!1})){const e=t;for(let t=0;t<this.rows*this.columns;t++)rt(this,tt)[t]+=e;return this}n(t,st);const e=t;if(this.rows!==e.rows||this.columns!==e.columns)throw new TypeError("Both matrices are not the same size; cannot perform operation.");for(let t=0;t<this.rows*this.columns;t++)rt(this,tt)[t]+=e.data[t];return this}subtract(t){if(i(t,"number",{throwError:!1})){const e=t;for(let t=0;t<this.rows*this.columns;t++)rt(this,tt)[t]-=e;return this}n(t,st);const e=t;if(this.rows!==e.rows||this.columns!==e.columns)throw new TypeError("Both matrices are not the same size; cannot perform operation.");for(let t=0;t<this.rows*this.columns;t++)rt(this,tt)[t]-=e.data[t];return this}multiply(t){if(i(t,"number",{throwError:!1})){const e=t;for(let t=0;t<this.rows*this.columns;t++)rt(this,tt)[t]*=e;return this}n(t,st);const e=t;if(this.columns!==e.rows)throw new TypeError(`The matrix provided must have ${this.columns} rows; cannot multiply matrices.`);const r=new st(this.rows,e.columns);for(let t=0;t<this.rows;t++)for(let s=0;s<this.columns;s++)for(let i=0;i<e.columns;i++)r.set(i,t,r.get(i,t)+this.get(s,t)*e.get(i,s));return et(this,tt,r.data),this}divide(t){i(t,"number");const e=1/t;for(let t=0;t<this.rows*this.columns;t++)rt(this,tt)[t]*=e;return this}toString(){let t="";for(let e=0;e<rt(this,tt).length;e+=this.columns){t+="( "+rt(this,tt)[e];for(let r=1;r<this.columns;r++)t+=" "+rt(this,tt)[e+r];t+=" )",e!==rt(this,tt).length-this.columns&&(t+=" ")}return t}}J=new WeakMap,Q=new WeakMap,tt=new WeakMap;class it extends st{constructor(t){super(4,4,t)}static identity(){return new it([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}static createRotationZ(t){const e=it.identity();return e.set(0,0,Math.cos(t)),e.set(1,0,Math.sin(t)),e.set(0,1,-Math.sin(t)),e.set(1,1,Math.cos(t)),e}static createTranslation(t,e,r){const s=it.identity();return t&&s.set(0,3,t),e&&s.set(1,3,e),r&&s.set(2,3,r),s}static createOrthographic(t,e,r,s){const i=it.identity();return i.set(0,0,2/t),i.set(1,1,2/e),i.set(2,2,1/(r-s)),i.set(2,3,r/(r-s)),i}static createLookAt(t,e,r){const s=D.subtract(t,e);s.normalize();const i=D.cross(r,s);i.normalize();const n=D.cross(s,i),a=it.identity();return a.set(0,0,i.x),a.set(1,0,n.x),a.set(2,0,s.x),a.set(0,1,i.y),a.set(1,1,n.y),a.set(2,1,s.y),a.set(0,2,i.z),a.set(1,2,n.z),a.set(2,2,s.z),a.set(0,3,-D.dot(i,t)),a.set(1,3,-D.dot(n,t)),a.set(2,3,-D.dot(s,t)),a}}class nt{constructor(){this.world=it.createTranslation(0,0,0),this.view=it.createLookAt(new D(0,0,1),new D(0,0,0),new D(0,1,0)),this.projection=it.createOrthographic(4,4,0,16),this.worldViewProjection=this.view.multiply(this.world).multiply(this.projection)}}export{B as AttributeElement,z as AttributeSchema,R as AttributeType,I as BasicEffect,nt as Camera,d as Color,M as Colors,V as DrawMode,st as DynamicMatrix,P as Effect,F as IndexBuffer,it as Matrix,q as Polygon,K as PolygonData,S as Sketch,D as Vector2,D as Vector3,D as Vector4,b as VertexBuffer,j as VertexUsage};
